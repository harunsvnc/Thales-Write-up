# Thales-Write-up
Vulnhub link:https://www.vulnhub.com/entry/thales-1,749/
Within this article, I'll post Thales vuln. machine solution
After VM import process, let's run arp-scan -l command to find out the IP address of our target.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/99edaed9-8946-4494-83ec-ac828284ef10)
In my case, IP address of the Thales machine is 10.0.2.5 and my Kali Linux IP is 10.0.2.4. 
Hence, I started a quick nmap scan to see the available ports and services on the target.
It seems, just port 22(ssh) and port 8080(tomcat) are running.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/864a2ee1-c774-4101-9e61-b2ab39a9531a)
When we visit the tomcat service on port 8080 there is a default tomcat page.

![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/017ecea5-5baa-4ae4-a9ee-cb5764fc8b81)

Also tomcat manager page is available for administratiron. When we click on the manager button, page was asking username and
password.To brute the page, I'll use metasploit's mgr_login plugin.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/4483ad0c-b74d-4678-bfbb-ef9402407cf1)
Let's configure our module.

![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/afc9f3a0-06d2-4a7a-ab45-e2dabe870dc3)
And run the module.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/e7cd4904-794e-4e7b-91ba-ea670c8f56fc)
Luckily, credentials are exist in the default wordlist of the module.
Let's test the credentials.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/69ba8185-8e15-4f4e-b5ff-38db717aeb65)
 Now, we're able to login the page.We can create and upload our .war(web archive) file that could be generated by msfvenom but i'll use other metasploit module for this purpose.
 ![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/1a522e8d-6ffd-4581-8928-70d9a6a95413)

![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/602755f1-d6da-4fef-96a4-4155420fdf43)
Hence, let's set the variables and run the exploit.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/711ff173-aba0-4687-b83a-165d5c600754)
Now we've a meterpreter session with limited privileges.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/93f4a921-16a7-4e2a-afba-63280aa215b5)
let's dig further at this point.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/0a946ea6-31cc-436a-ab77-7fd31ea17f62)
In the home folder of the thales user, there is a readable notes.txt file and wrongly set .ssh file. I started a dummy web
server with python to download the private key to my local machine.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/5ba4591f-8020-4182-b82c-717461b39ea9)
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/a5088e58-015b-4cc1-8a20-cf04a15c49c5)

Good news, we've a private key of a user let's try to ssh into the target with this key.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/2c4d231e-9919-41a0-886d-d669f8bfec59)

Private key was protected by a passphrase, i tried empty password but didn't work. We can use JTR to crack the key.
first we have to use ssh2john module to make it john's familiar format. than I used rockyou.txt as a wordlist.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/de149c3c-53d0-4cfc-9e71-6c363e97519f)

![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/8c7e3056-bd87-4653-8f0d-d46d55a4948d)
we found a password vodka06. let's try to ssh with this password.

![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/59f49170-6151-4948-b3b6-2eeff92c215f)

System doesn't let us to ssh remotely. let's use our active session to switch the user.

![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/946081ed-cd9e-415a-97f7-8bc59395f488)
It worked and here is the user flag.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/61df4529-0f3a-4120-af4a-c6586b1bf273)

now at this point we can focus on the notes found in our home folder. there is script file that backs up periodically
and we've permissions to modify the file.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/a3bcfc70-dfba-48ed-9b41-45980abdb7c8)

to manipulate the file, let's visit pentestmonkey's shells.
https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
I used first one.


![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/788f52a2-0ae4-4fbd-9585-b96e2aa279cb)

![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/d56d3acb-2283-429e-9f2d-232a8e0f45de)
After a while, automatically you should gain root account.
![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/4e322a57-4051-4f4f-b4a4-8cd3df368c29)

![image](https://github.com/harunsvnc/Thales-Write-up/assets/75423540/99a887c4-ecc2-443d-9200-769816fc6e3d)
